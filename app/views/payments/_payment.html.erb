<tr data-payment-id="<%= payment.id %>">
  <td><%= payment.created_at.to_date %></td>
  <td><%= payment.payment_type %></td>
  <td><%= number_to_currency(payment.amount) %></td>
  <td><%= number_to_currency(payment.applied_amount) %></td>
  <td><%= number_to_currency(payment.unapplied_amount) %></td>
  <td><%= payment.number %></td>
  <td>
    <% if !payment.success? %>
      <% if payment.payment_type == 'CreditCardPayment' %>
        <%= link_to('finalize', finalize_payment_path(payment), method: :put, remote: true, class: 'btn btn-default btn-sm') %>
      <% elsif payment.payment_type == 'CheckPayment' %>
        <%= form_for payment, url: finalize_payment_path(payment), remote: true, html: {method: "put"} do |f| %>
          <div class="input-group">
            <%= f.text_field :check_number, class: "form-control input-sm", placeholder: 'Check number' %>
            <span class="input-group-btn">
              <%= f.button :finalize, class: 'btn btn-default btn-sm' %>
            </span>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </td>
  <td><%= payment.success? %></td>
  <td>
    <div class="dropdown">
      <button class="btn btn-default btn-xs dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu pull-right" aria-labelledby="dropdownMenu1">
        <% payment.order_payment_applications.each do |app| %>
          <li><a><%= "#{app.order.number} - #{number_to_currency(app.applied_amount)}" %></a></li>
        <% end %>
      </ul>
    </div>
  </td>
</tr>
